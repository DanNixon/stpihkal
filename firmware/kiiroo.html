
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Kiiroo Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Protocols and Memory Layouts
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../hardware/bkk.html">
            
                <a href="../hardware/bkk.html">
            
                    
                    BKK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../hardware/erostek-et232.html">
            
                <a href="../hardware/erostek-et232.html">
            
                    
                    Erostek ET232
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../hardware/erostek-et312b.html">
            
                <a href="../hardware/erostek-et312b.html">
            
                    
                    Erostek ET312B
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../hardware/estim-systems-2b.html">
            
                <a href="../hardware/estim-systems-2b.html">
            
                    
                    Estim Systems 2B
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../hardware/fleshlight-launch.html">
            
                <a href="../hardware/fleshlight-launch.html">
            
                    
                    Fleshlight Launch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../hardware/kiiroo-onyx-pearl-1.html">
            
                <a href="../hardware/kiiroo-onyx-pearl-1.html">
            
                    
                    Kiiroo Onyx 1/Pearl 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../hardware/kiiroo-onyx-2.html">
            
                <a href="../hardware/kiiroo-onyx-2.html">
            
                    
                    Kiiroo Onyx 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="../hardware/lovense.html">
            
                <a href="../hardware/lovense.html">
            
                    
                    Lovense (All)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="../hardware/mysteryvibe.html">
            
                <a href="../hardware/mysteryvibe.html">
            
                    
                    MysteryVibe Crescendo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="../hardware/vibratissimo.html">
            
                <a href="../hardware/vibratissimo.html">
            
                    
                    Vibratissimo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11" data-path="../hardware/vorze-sa.html">
            
                <a href="../hardware/vorze-sa.html">
            
                    
                    Vorze SA (A10 Cyclone SA, UFO SA)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Firmware and Bootloaders
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.3.1" data-path="kiiroo.html">
            
                <a href="kiiroo.html">
            
                    
                    Kiiroo
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Network Protocols
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../network/kiiroo-platform-server.html">
            
                <a href="../network/kiiroo-platform-server.html">
            
                    
                    Kiiroo Platform Server
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    Video Encoding Formats
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../video-encoding-formats/feelme.html">
            
                <a href="../video-encoding-formats/feelme.html">
            
                    
                    Feelme
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../video-encoding-formats/funscript.html">
            
                <a href="../video-encoding-formats/funscript.html">
            
                    
                    Funscript
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../video-encoding-formats/kiiroo.html">
            
                <a href="../video-encoding-formats/kiiroo.html">
            
                    
                    Kiiroo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../video-encoding-formats/realtouch.html">
            
                <a href="../video-encoding-formats/realtouch.html">
            
                    
                    RealTouch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../video-encoding-formats/virtualrealplayer.html">
            
                <a href="../video-encoding-formats/virtualrealplayer.html">
            
                    
                    VirtualRealPlayer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="../video-encoding-formats/vorze-interactive.html">
            
                <a href="../video-encoding-formats/vorze-interactive.html">
            
                    
                    Vorze Interactive
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    Misc
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../misc/buttplug-redirect.html">
            
                <a href="../misc/buttplug-redirect.html">
            
                    
                    Buttplug Redirect
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Kiiroo</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="kiiroo-bootloader-and-firmware">Kiiroo Bootloader and Firmware</h1>
<p>While it would be a great marketing strategy for the kind of people
that read this document, there is not actually a toy called the Kiiroo
Bootloader. Rather, this refers to the common bootloader that comes
installed on Kiiroo toys, such asthe Fleshlight Launch, Pearl 2, Onyx
2, and others. The bootloader is used to update the on system firmware
over Bluetooth, a sketchy venture in the best of conditions.</p>
<h3 id="command-structure-and-flow">Command Structure and Flow</h3>
<p>Most Kiiroo toys will have 3 characteristics. </p>
<ul>
<li>Bootloader Commands/Control (CTL)</li>
<li>Data (DATA)</li>
<li>Sensor (SENSOR)</li>
</ul>
<p>All bootloader related commands go to CTL.</p>
<p>Commands sent to the boot loader are 2 bytes, sent by setting the
value of CTL with 1 byte, then the value of DATA with 1 byte.</p>
<pre><code>0xGG -&gt; CTL
0xHH -&gt; DATA
</code></pre><ul>
<li>0xGG - Byte 0 - command index</li>
<li>0xHH - Byte 1 - command data</li>
</ul>
<p>After this, CTL is read, and the value signifies the success/failure
of the operation.</p>
<ul>
<li>0x02 - Success</li>
<li>Anything not 0x2 - Failure</li>
</ul>
<p>If the operation succeeds and expects data back, it will read the DATA
characteristic. Data returns can vary in length. If this is the case, </p>
<h3 id="commands">Commands</h3>
<h4 id="get-execution-mode">Get Execution Mode</h4>
<p>Retrieves information about the current execution mode of the
hardware.</p>
<p><strong>Command:</strong></p>
<ul>
<li>Command Index: 0x03</li>
<li>Command Data: 0x00</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>Byte[1] &amp; 0x0 - Bootloader Mode</li>
<li>Byte[1] &amp; 0x1 - Application Mode</li>
</ul>
<h4 id="set-execution-mode">Set Execution Mode</h4>
<p>Change the execution mode to Bootloader mode and resets the device.</p>
<p><strong>Command:</strong></p>
<ul>
<li>Command Index: 0x06</li>
<li>Command Data: 0x00</li>
</ul>
<p><strong>Returns:</strong></p>
<p>None, device will most likely disconnect after command.</p>
<h4 id="get-software-version">Get Software Version</h4>
<p>Retrieves information about the version of the firmware currently on
the hardware.</p>
<p><strong>Command:</strong></p>
<ul>
<li>Command Index: 0x05</li>
<li>Command Data: 0x00</li>
</ul>
<p><strong>Returns:</strong></p>
<p>If return is 6 bytes:</p>
<ul>
<li>Byte[4] - Major Version</li>
<li>Byte[5] - Minor Version</li>
</ul>
<p>If return is 12 bytes:</p>
<ul>
<li>Byte[10] - Major Version</li>
<li>Byte[11] - Minor Version</li>
</ul>
<p>For example, if the firmware version is v1.3, and the return is 6
bytes, we expect it to look like</p>
<pre><code>0xXX 0xXX 0xXX 0xXX 0x01 0x03
</code></pre><h4 id="get-flash-information">Get Flash Information</h4>
<p>Retrieves information about the on-chip flash. As toys may have
different chips with differing sizes of flash, return sizes may vary.</p>
<p><strong>Command:</strong></p>
<ul>
<li>Command Index: 0x0A</li>
<li>Command Data: 0x00</li>
</ul>
<p><strong>Returns:</strong></p>
<p>If return is 7 bytes:</p>
<ul>
<li>High nibble of Byte[0] - Address Increment</li>
<li>Low nibble of Byte[0] - Word Size</li>
<li>Byte[1] &lt;&lt; 8 || Byte[2] - Program Length</li>
<li>Byte[3] &lt;&lt; 8 || Byte[4] - Program Base</li>
<li>Byte[5] &lt;&lt; 8 || Byte[6] - Row Length</li>
</ul>
<p>If return is 9 bytes:</p>
<ul>
<li>Byte[0] - Flash Erase Value</li>
<li>High nibble of Byte[1] - Address Increment</li>
<li>Low nibble of Byte[1] - Word Size</li>
<li>Byte[2] &lt;&lt; 8 || Byte[3] - Program Length</li>
<li>Byte[4] &lt;&lt; 16 || Byte[5] &lt;&lt; 8 || Byte[6] - Program Base</li>
<li>Byte[7] &lt;&lt; 8 || Byte[8] - Row Length</li>
</ul>
<h4 id="erase-memory">Erase Memory</h4>
<p>Erases the flash of the internal microcontroller.</p>
<p><strong>Command:</strong></p>
<ul>
<li>Command Index: 0x09</li>
<li>Command Data: 0x00</li>
</ul>
<p><strong>Returns:</strong></p>
<p>No return value.</p>
<h4 id="verify-memory">Verify Memory</h4>
<p>Verifies memory. Not sure what this means.</p>
<p><strong>Command:</strong></p>
<ul>
<li>Command Index: 0x08</li>
<li>Command Data: 0x00</li>
</ul>
<p><strong>Returns:</strong></p>
<p>No return value.</p>
<h4 id="get-crc">Get CRC</h4>
<p>Returns the CRC of the currently loaded firmware.</p>
<p><strong>Command:</strong></p>
<ul>
<li>Command Index: 0x07</li>
<li>Command Data: 0x00</li>
</ul>
<p><strong>Returns:</strong></p>
<p>CRC string for the loaded firmware.</p>
<h4 id="push-block">Push Block</h4>
<p>Sends a block of firmware code to the device to be written to flash.</p>
<p><strong>Command:</strong></p>
<ul>
<li>Command Index: 0x0b</li>
<li>Command Data: Row data, variable length</li>
</ul>
<p><strong>Returns:</strong></p>
<p>Nothing</p>
<h4 id="write-block">Write Block</h4>
<p>Writes the previously pushed block to flash.</p>
<p><strong>Command:</strong></p>
<ul>
<li>Command Index: 0x0c</li>
<li>Command Data: Memory row to write to, as string with leading zeros.</li>
</ul>
<p><strong>Returns:</strong></p>
<p>Nothing</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Kiiroo","level":"1.3.1","depth":2,"next":{"title":"Network Protocols","level":"1.4","depth":1,"ref":"","articles":[{"title":"Kiiroo Platform Server","level":"1.4.1","depth":2,"path":"network/kiiroo-platform-server.md","ref":"network/kiiroo-platform-server.md","articles":[]}]},"previous":{"title":"Firmware and Bootloaders","level":"1.3","depth":1,"ref":"","articles":[{"title":"Kiiroo","level":"1.3.1","depth":2,"path":"firmware/kiiroo.md","ref":"firmware/kiiroo.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["piwik"],"root":"./stpihkal","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"piwik":{"jsPath":"js/","phpPath":"js/","URL":"apps.nonpolynomial.com/p/","siteId":8},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"gitbook":"*"},"file":{"path":"firmware/kiiroo.md","mtime":"2018-05-25T06:25:06.732Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-05-25T06:26:29.940Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-piwik/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    


    <script type="text/javascript">
        var _paq = _paq || [];
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function() {
            var u=(('https:' == document.location.protocol) ? 'https' : 'http') + '://apps.nonpolynomial.com/p/';
            // Ensure URL ends with slash
            if (u.slice(-1) !== '/') u+='/';
            _paq.push(['setTrackerUrl', u+'js/']);
            _paq.push(['setSiteId', 8]);
            var d=document,
                g=d.createElement('script'),
                s=d.getElementsByTagName('script')[0];
            g.type='text/javascript';
            g.defer=true;
            g.async=true;
            g.src=u+'js/';
            s.parentNode.insertBefore(g,s);
        })();
    </script>
    <noscript>
        <p><img src="http://apps.nonpolynomial.com/p/js/?idsite=8"
                style="border:0;" alt="" /></p>
    </noscript>

    </body>
</html>

